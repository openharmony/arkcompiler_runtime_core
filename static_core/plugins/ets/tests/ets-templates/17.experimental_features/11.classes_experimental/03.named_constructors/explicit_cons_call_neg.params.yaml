# Copyright (c) 2026 Huawei Device Co., Ltd.
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

---
cases:
    - expected_out: |-
          Semantic error ESE0235: Using this is not allowed in constructor
      decl: |-
          // CTE if arguments of an explicit constructor call refer to a field
          class A {
              s: string
              fld: string = 'hello'
              constructor fromString(p: string) {
                  this.s = p
              }
              constructor noArgs() {
                  this.fromString(this.fld)  // CTE, cannot use this.fld
              }
          }

    - expected_out: |-
          Semantic error ESE0235: Using this is not allowed in constructor
      decl: |-
          // CTE if arguments of an explicit constructor call refer to a field
          class A {
              s: string
              readonly fld: string = 'hello'
              constructor fromString(p: string) {
                  this.s = p
              }
              constructor() {
                  this.fromString(this.fld)  // CTE, cannot use this.fld
              }
          }

    - expected_out: |-
          Semantic error ESE0235: Using this is not allowed in constructor
      decl: |-
          // CTE if arguments of an explicit constructor call refer to an instance method
          class A {
              s: string
              constructor fromString(p: string) {
                  this.s = p
              }
              constructor noArgs() {
                  this.fromString(this.meth())  // CTE, cannot use this.meth()
              }
              meth(): string {
                  return 'hello'
              }
          }

    - expected_out: |-
          Semantic error ESE0235: Using this is not allowed in constructor
      decl: |-
          // CTE if arguments of an explicit constructor call refer to an instance method
          class A {
              s: string
              constructor fromFunc(p: () => string) {
                  this.s = p()
              }
              constructor() {
                  this.fromFunc(this.meth)  // CTE, cannot use this.meth
              }
              meth(): string {
                  return 'hello'
              }
          }

    - expected_out: |-
          Semantic error ESE0235: Using this is not allowed in constructor
      decl: |-
          // CTE if arguments of an explicit constructor call refer to this
          class A {
              s: string|undefined
              constructor fromA(p: A) {
                  this.s = p.s ?? 'hello'
              }
              constructor() {
                  this.fromA(this)  // CTE, cannot use this in args
              }
          }

    - expected_out: |-
          Semantic error ESE0235: Using super is not allowed in constructor
      decl: |-
          // CTE if arguments of an explicit constructor call refer to a super field
          class A {
              s: string
              readonly fld: string = 'hello'
              constructor fromString(p: string) {
                  this.s = p
              }
          }
          class B extends A {
              constructor fromString(p: string) {
                  super.fromString(p)
              }
              constructor() {
                  this.fromString(super.fld) // CTE, cannot use super field in args
              }
          }

    - expected_out: |-
          Semantic error ESE0235: Using super is not allowed in constructor
      decl: |-
          // CTE if arguments of an explicit constructor call refer to a super field
          class A {
              s: string
              fld: string = 'hello'
              constructor fromString(p: string) {
                  this.s = p
              }
          }
          class B extends A {
              constructor fromString(p: string) {
                  super.fromString(p)
              }
              constructor noArgs() {
                  this.fromString(super.fld) // CTE, cannot use super field in args
              }
          }

    - expected_out: |-
          Semantic error ESE0235: Using super is not allowed in constructor
      decl: |-
          // CTE if arguments of an explicit constructor call refer to a super method
          class A {
              s: string
              constructor fromString(p: string) {
                  this.s = p
              }
              meth(): string {
                  return 'hello'
              }
          }
          class B extends A {
              constructor fromString(p: string) {
                  super.fromString(p)
              }
              constructor() {
                  this.fromString(super.meth()) // CTE, cannot use super method in args
              }
          }

    - expected_out: |-
          Semantic error ESE0235: Using super is not allowed in constructor
      decl: |-
          // CTE if arguments of an explicit constructor call refer to a super method
          class A {
              s: string
              constructor fromFunc(p: () => string) {
                  this.s = p()
              }
              meth(): string {
                  return 'hello'
              }
          }
          class B extends A {
              constructor fromFunc(p: () => string) {
                  super.fromFunc(p)
              }
              constructor() {
                  this.fromFunc(super.meth) // CTE, cannot use super method in args
              }
          }

    - expected_out: |-
          Syntax error ESY0061: Unexpected super keyword.
      decl: |-
          // CTE if arguments of an explicit constructor call refer to super
          class A {
              s: string|undefined
              constructor fromA(p: A) {
                  this.s = p.s ?? 'hello'
              }
          }
          class B extends A {
              constructor fromA(p: A) {
                  super.fromA(p)
              }
              constructor() {
                  this.fromA(super) // CTE, cannot use super in args
              }
          }

    - expected_out: |-
          Syntax error ESY0061: Unexpected super keyword.
      decl: |-
          // CTE if arguments of an explicit constructor call refer to super
          class A {
              s: string|undefined
              constructor fromA(p: A) {
                  this.s = p.s ?? 'hello'
              }
          }
          class B extends A {
              constructor(p: A) {
                  super.fromA(p)
              }
              constructor() {
                  super.fromA(super) // CTE, cannot use super in args
              }
          }

    - expected_out: |-
          Semantic error ESE0235: Using this is not allowed in constructor
      decl: |-
          // CTE if arguments of an explicit constructor call refer to this
          class A {
              s: string|undefined
              constructor fromA(p: A) {
                  this.s = p.s ?? 'hello'
              }
          }
          class B extends A {
              constructor(p: A) {
                  super.fromA(p)
              }
              constructor() {
                  super.fromA(this) // CTE, cannot use this in args
              }
          }
