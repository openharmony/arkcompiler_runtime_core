# Copyright (c) 2026 Huawei Device Co., Ltd.
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

type: workflow
workflow-name: workflow
parameters:
    build: ${PANDA_BUILD}
    work-dir: ${parameters.work-dir}
    output-file: "${parameters.work-dir}/intermediate/${test-id}.abc"
steps:
    echo-stdout:
        pre-reqs:
            - req: FileExist
              value: "${parameters.work-dir}/gen/simple_co.ets"
            - req: FolderExist
              value: "${parameters.work-dir}/gen"
            - req: ParentExistCreate
              value: "${parameters.work-dir}/intermediate/report/out.txt"
        executable-path: /usr/bin/echo
        timeout: 45
        can-be-instrumented: "false"
        enabled: "true"
        skip-qemu: "true"
        step-type: compiler
        step-filter: "*.abc"
        args:
            - "--output=${parameters.output-file}"
        stdout: "${parameters.work-dir}/intermediate/report/${test-id}-stdout.txt"
        stderr: "${parameters.work-dir}/intermediate/report/${test-id}-stderr.txt"
        post-reqs:
            - req: FolderExist
              value: "${parameters.work-dir}/intermediate/report"
            - req: FileExist
              value: "${parameters.work-dir}/intermediate/report/${test-id}-stdout.txt"
            - req: FileExist
              value: "${parameters.work-dir}/intermediate/report/${test-id}-stderr.txt"
        validator: "runner.test.test_steps_test.return_1_validator.Return1Validator"
        env:
            env1: value11
            env2:
              - value21
              - value22
